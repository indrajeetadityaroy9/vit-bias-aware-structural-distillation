run:
  name: basd_imagenet
  output_dir: ./outputs
  seed: 42

data:
  dataset: imagenet1k
  eval_datasets: []
  batch_size: 256
  num_workers: 16

model:
  student_preset: ""
  in_channels: 3
  num_classes: 0
  vit:
    img_size: 224
    patch_size: 16
    embed_dim: 192
    depth: 12
    num_heads: 3
    drop_path_rate: 0.1

checkpoint:
  resume_from: null
  path: null

training:
  num_epochs: 300
  learning_rate: 1.0e-3
  weight_decay: 0.05
  warmup_fraction: 0.05
  label_smoothing: 0.1
  early_stopping_patience: 20
  early_stopping_min_delta: 0.001
  swa_start_epoch: 0.8
  swa_lr: 1.0e-4
  grad_clip_norm: 1.0
  cosine_eta_min: 1.0e-6
  autocast_dtype: bfloat16

basd:
  teacher_model_name: dinov2_vits14
  token_layers: [3, 6, 9, 11]
  warmup_fraction: 0.1
  disable_components: []
  warmup_stagger:
    rsd: 0.0
    rel: 0.25
    attn: 0.25
    spectral: 0.5
  uwso_temperature: 2.0
  vrm_num_pairs: 128
  layer_selector_temperature: 2.0
  layer_selector_diversity_weight: 0.01
  layer_selector_recon_weight: 0.01
  layer_selector_grass_proj_dim: 128
  layer_selector_grass_rank: 16
  layer_selector_grass_cov_eps: 1.0e-4

presets:
  deit_tiny:
    embed_dim: 192
    depth: 12
    num_heads: 3
  deit_small:
    embed_dim: 384
    depth: 12
    num_heads: 6
  deit_base:
    embed_dim: 768
    depth: 12
    num_heads: 12
